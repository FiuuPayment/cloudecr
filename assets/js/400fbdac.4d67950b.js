"use strict";(self.webpackChunkcloudecr=self.webpackChunkcloudecr||[]).push([[467],{514:(e,n,t)=>{t.r(n),t.d(n,{assets:()=>o,contentTitle:()=>c,default:()=>p,frontMatter:()=>u,metadata:()=>r,toc:()=>d});const r=JSON.parse('{"id":"signature","title":"Signature","description":"The signature is used to verify the integrity and authenticity of the API request. It ensures that the payload has not been altered (tampered with) during transmission and that the request originates from a trusted source.","source":"@site/docs/signature.md","sourceDirName":".","slug":"/signature","permalink":"/cloudECR/docs/signature","draft":false,"unlisted":false,"tags":[],"version":"current","frontMatter":{},"sidebar":"sidebar","previous":{"title":"API Reference","permalink":"/cloudECR/docs/api-reference"},"next":{"title":"Developer Supports","permalink":"/cloudECR/docs/developer-tools-support"}}');var a=t(4848),s=t(1184),l=t(4435),i=t(95);const u={},c="Signature",o={},d=[{value:"Sign Strategy",id:"sign-strategy",level:2},{value:"Example",id:"example",level:2},{value:"Sample Sale Request Payload",id:"sample-sale-request-payload",level:3},{value:"Step 1: Extract Parameter Values",id:"step-1-extract-parameter-values",level:3},{value:"Step 2: Sort Values Alphabetically",id:"step-2-sort-values-alphabetically",level:3},{value:"Step 3: Concatenate Sorted Values",id:"step-3-concatenate-sorted-values",level:3},{value:"Step 4: Generate HMAC-SHA256 Hash",id:"step-4-generate-hmac-sha256-hash",level:3}];function h(e){const n={code:"code",h1:"h1",h2:"h2",h3:"h3",header:"header",li:"li",p:"p",pre:"pre",strong:"strong",ul:"ul",...(0,s.R)(),...e.components};return(0,a.jsxs)(a.Fragment,{children:[(0,a.jsx)(n.header,{children:(0,a.jsx)(n.h1,{id:"signature",children:"Signature"})}),"\n",(0,a.jsx)(n.p,{children:"The signature is used to verify the integrity and authenticity of the API request. It ensures that the payload has not been altered (tampered with) during transmission and that the request originates from a trusted source."}),"\n",(0,a.jsx)(n.h2,{id:"sign-strategy",children:"Sign Strategy"}),"\n",(0,a.jsxs)(n.ul,{children:["\n",(0,a.jsxs)(n.li,{children:["The signature is an ",(0,a.jsx)(n.strong,{children:"HMAC-SHA256 hash"})," generated from a sequence of parameter values combined with a ",(0,a.jsx)(n.strong,{children:"secret key"}),"."]}),"\n",(0,a.jsxs)(n.li,{children:["The ",(0,a.jsx)(n.strong,{children:"secret key"})," is a server-side shared secret assigned to merchants by ",(0,a.jsx)(n.strong,{children:"Fiuu"}),"."]}),"\n",(0,a.jsxs)(n.li,{children:["All parameters included in the message exchange are part of the signature calculation ",(0,a.jsx)(n.strong,{children:"except"}),":","\n",(0,a.jsxs)(n.ul,{children:["\n",(0,a.jsx)(n.li,{children:"Empty parameters (not zero values)."}),"\n",(0,a.jsxs)(n.li,{children:["The ",(0,a.jsx)(n.code,{children:"signature"})," parameter itself."]}),"\n"]}),"\n"]}),"\n",(0,a.jsxs)(n.li,{children:["Rules for generating the signature:","\n",(0,a.jsxs)(n.ul,{children:["\n",(0,a.jsxs)(n.li,{children:["Sort all parameter values ",(0,a.jsx)(n.strong,{children:"alphabetically"}),"."]}),"\n",(0,a.jsxs)(n.li,{children:["Use original parameter values (do ",(0,a.jsx)(n.strong,{children:"not"})," URL-encode)."]}),"\n",(0,a.jsxs)(n.li,{children:["Treat all parameters as ",(0,a.jsx)(n.strong,{children:"case-sensitive"}),"."]}),"\n"]}),"\n"]}),"\n",(0,a.jsxs)(n.li,{children:["Include a ",(0,a.jsx)(n.strong,{children:"datetime"})," parameter in the signature to prevent duplicate transactions."]}),"\n"]}),"\n",(0,a.jsx)(n.h2,{id:"example",children:"Example"}),"\n",(0,a.jsx)(n.p,{children:"For this example, we will use:"}),"\n",(0,a.jsxs)(n.ul,{children:["\n",(0,a.jsxs)(n.li,{children:[(0,a.jsx)(n.strong,{children:"MID"}),": ",(0,a.jsx)(n.code,{children:"603778000000001"})]}),"\n",(0,a.jsxs)(n.li,{children:[(0,a.jsx)(n.strong,{children:"TID"}),": ",(0,a.jsx)(n.code,{children:"91100033"})]}),"\n",(0,a.jsxs)(n.li,{children:[(0,a.jsx)(n.strong,{children:"merchantId"}),": ",(0,a.jsx)(n.code,{children:"fiuuMerch1"})]}),"\n",(0,a.jsxs)(n.li,{children:[(0,a.jsx)(n.strong,{children:"secretKey"}),": ",(0,a.jsx)(n.code,{children:"75DC529B942513DFA77F43EC3451F137"})]}),"\n"]}),"\n",(0,a.jsx)(n.h3,{id:"sample-sale-request-payload",children:"Sample Sale Request Payload"}),"\n",(0,a.jsx)(n.pre,{children:(0,a.jsx)(n.code,{className:"language-json",children:'{\n  "transType": "sale",\n  "posId": "fiuuPos1",\n  "merchantId": "fiuuMerch1",\n  "deviceId": "fiuuDeviceId1",\n  "referenceId": "fiuuPosRefId1",\n  "referenceLabel": "Contrib ID",\n  "apiVersion": "v1",\n  "datetime": "20250115081928",\n  "transData": {\n    "transAmt": "1.00",\n    "paymentMethod": "bankCard",\n    "note": "This is a test note"\n  }\n}\n'})}),"\n",(0,a.jsx)(n.h3,{id:"step-1-extract-parameter-values",children:"Step 1: Extract Parameter Values"}),"\n",(0,a.jsx)(n.p,{children:"Flatten the payload into a list of values:"}),"\n",(0,a.jsx)(n.pre,{children:(0,a.jsx)(n.code,{className:"language-json",children:'[\n  "sale",\n  "fiuuPos1",\n  "fiuuMerch1",\n  "fiuuDeviceId1",\n  "fiuuPosRefId1",\n  "Contrib ID",\n  "v1",\n  "20250115081928",\n  "1.00",\n  "bankCard",\n  "This is a test note"\n]\n'})}),"\n",(0,a.jsx)(n.p,{children:(0,a.jsx)(n.strong,{children:"Sample function to flatten the object in multiple languages:"})}),"\n",(0,a.jsxs)(i.A,{children:[(0,a.jsx)(l.A,{value:"JavaScript",label:"JavaScript",children:(0,a.jsx)(n.pre,{children:(0,a.jsx)(n.code,{className:"language-javascript",children:'function flattenObject(obj) {\n  let result = [];\n  for (let key in obj) {\n    if (typeof obj[key] === "object" && obj[key] !== null) {\n      result = result.concat(flattenObject(obj[key]));\n    } else {\n      result.push(obj[key]);\n    }\n  }\n  return result;\n}\n'})})}),(0,a.jsx)(l.A,{value:"PHP",label:"PHP",children:(0,a.jsx)(n.pre,{children:(0,a.jsx)(n.code,{className:"language-php",children:"function flattenObject($obj) {\n    $result = [];\n\n    foreach ($obj as $key => $value) {\n        if (is_array($value) || is_object($value)) {\n            $result = array_merge($result, flattenObject((array)$value));\n        } else {\n            $result[] = $value;\n        }\n    }\n\n    return $result;\n}\n"})})}),(0,a.jsx)(l.A,{value:"CSharp",label:"C#",children:(0,a.jsx)(n.pre,{children:(0,a.jsx)(n.code,{className:"language-csharp",children:"using System.Collections.Generic;\n\nList<object> FlattenObject(Dictionary<string, object> obj)\n{\n    var result = new List<object>();\n\n    foreach (var kv in obj)\n    {\n        if (kv.Value is Dictionary<string, object> nested)\n        {\n            result.AddRange(FlattenObject(nested));\n        }\n        else\n        {\n            result.Add(kv.Value);\n        }\n    }\n\n    return result;\n}\n"})})}),(0,a.jsx)(l.A,{value:"Java",label:"Java",children:(0,a.jsx)(n.pre,{children:(0,a.jsx)(n.code,{className:"language-java",children:"import java.util.*;\n\npublic static List<Object> flattenObject(Map<String, Object> obj) {\n    List<Object> result = new ArrayList<>();\n\n    for (Map.Entry<String, Object> entry : obj.entrySet()) {\n        Object value = entry.getValue();\n\n        if (value instanceof Map) {\n            result.addAll(flattenObject((Map<String, Object>) value));\n        } else {\n            result.add(value);\n        }\n    }\n\n    return result;\n}\n"})})}),(0,a.jsx)(l.A,{value:"Go",label:"Go",children:(0,a.jsx)(n.pre,{children:(0,a.jsx)(n.code,{className:"language-go",children:"func FlattenObject(obj map[string]interface{}) []interface{} {\n    result := []interface{}{}\n\n    for _, v := range obj {\n        if nested, ok := v.(map[string]interface{}); ok {\n            result = append(result, FlattenObject(nested)...)\n        } else {\n            result = append(result, v)\n        }\n    }\n\n    return result\n}\n"})})}),(0,a.jsx)(l.A,{value:"Dart",label:"Dart",children:(0,a.jsx)(n.pre,{children:(0,a.jsx)(n.code,{className:"language-dart",children:"List<dynamic> flattenObject(Map<String, dynamic> obj) {\n  List<dynamic> result = [];\n\n  obj.forEach((key, value) {\n    if (value is Map<String, dynamic>) {\n      result.addAll(flattenObject(value));\n    } else {\n      result.add(value);\n    }\n  });\n\n  return result;\n}\n"})})})]}),"\n",(0,a.jsx)(n.h3,{id:"step-2-sort-values-alphabetically",children:"Step 2: Sort Values Alphabetically"}),"\n",(0,a.jsx)(n.pre,{children:(0,a.jsx)(n.code,{className:"language-JSON",children:'[\n  "1.00",\n  "20250115081928",\n  "Contrib ID",\n  "This is a test note",\n  "bankCard",\n  "fiuuDeviceId1",\n  "fiuuMerch1",\n  "fiuuPos1",\n  "fiuuPosRefId1",\n  "sale",\n  "v1"\n]\n'})}),"\n",(0,a.jsx)(n.h3,{id:"step-3-concatenate-sorted-values",children:"Step 3: Concatenate Sorted Values"}),"\n",(0,a.jsx)(n.p,{children:"Concatenate the actual values of the parameters in the sorted order:"}),"\n",(0,a.jsx)(n.pre,{children:(0,a.jsx)(n.code,{children:"1.0020250115081928Contrib IDThis is a test notebankCardfiuuDeviceId1fiuuMerch1fiuuPos1fiuuPosRefId1salev1\n"})}),"\n",(0,a.jsx)(n.h3,{id:"step-4-generate-hmac-sha256-hash",children:"Step 4: Generate HMAC-SHA256 Hash"}),"\n",(0,a.jsxs)(n.p,{children:["Apply HMAC-SHA256 using the ",(0,a.jsx)(n.strong,{children:"secret key"}),":"]}),"\n",(0,a.jsx)(n.pre,{children:(0,a.jsx)(n.code,{className:"language-javascript",children:'HMAC_SHA256(\n  "1.0020250115081928Contrib IDThis is a test notebankCardfiuuDeviceId1fiuuMerch1fiuuPos1fiuuPosRefId1salev1",\n  "75DC529B942513DFA77F43EC3451F137"\n);\n'})}),"\n",(0,a.jsx)(n.p,{children:(0,a.jsx)(n.strong,{children:"Resulting Hash:"})}),"\n",(0,a.jsx)(n.pre,{children:(0,a.jsx)(n.code,{children:"e2c28c6eb6470e99ead904decf5a70e14f99c2a3f6f43597221557dc4614fc66\n"})})]})}function p(e={}){const{wrapper:n}={...(0,s.R)(),...e.components};return n?(0,a.jsx)(n,{...e,children:(0,a.jsx)(h,{...e})}):h(e)}},4435:(e,n,t)=>{t.d(n,{A:()=>l});t(6540);var r=t(4357);const a={tabItem:"tabItem_OMyP"};var s=t(4848);function l({children:e,hidden:n,className:t}){return(0,s.jsx)("div",{role:"tabpanel",className:(0,r.A)(a.tabItem,t),hidden:n,children:e})}},95:(e,n,t)=>{t.d(n,{A:()=>S});var r=t(6540),a=t(4357),s=t(5245),l=t(6090),i=t(3190),u=t(838),c=t(6423),o=t(2066);function d(e){return r.Children.toArray(e).filter((e=>"\n"!==e)).map((e=>{if(!e||(0,r.isValidElement)(e)&&function(e){const{props:n}=e;return!!n&&"object"==typeof n&&"value"in n}(e))return e;throw new Error(`Docusaurus error: Bad <Tabs> child <${"string"==typeof e.type?e.type:e.type.name}>: all children of the <Tabs> component should be <TabItem>, and every <TabItem> should have a unique "value" prop.`)}))?.filter(Boolean)??[]}function h(e){const{values:n,children:t}=e;return(0,r.useMemo)((()=>{const e=n??function(e){return d(e).map((({props:{value:e,label:n,attributes:t,default:r}})=>({value:e,label:n,attributes:t,default:r})))}(t);return function(e){const n=(0,c.XI)(e,((e,n)=>e.value===n.value));if(n.length>0)throw new Error(`Docusaurus error: Duplicate values "${n.map((e=>e.value)).join(", ")}" found in <Tabs>. Every value needs to be unique.`)}(e),e}),[n,t])}function p({value:e,tabValues:n}){return n.some((n=>n.value===e))}function f({queryString:e=!1,groupId:n}){const t=(0,l.W6)(),a=function({queryString:e=!1,groupId:n}){if("string"==typeof e)return e;if(!1===e)return null;if(!0===e&&!n)throw new Error('Docusaurus error: The <Tabs> component groupId prop is required if queryString=true, because this value is used as the search param name. You can also provide an explicit value such as queryString="my-search-param".');return n??null}({queryString:e,groupId:n});return[(0,u.aZ)(a),(0,r.useCallback)((e=>{if(!a)return;const n=new URLSearchParams(t.location.search);n.set(a,e),t.replace({...t.location,search:n.toString()})}),[a,t])]}function j(e){const{defaultValue:n,queryString:t=!1,groupId:a}=e,s=h(e),[l,u]=(0,r.useState)((()=>function({defaultValue:e,tabValues:n}){if(0===n.length)throw new Error("Docusaurus error: the <Tabs> component requires at least one <TabItem> children component");if(e){if(!p({value:e,tabValues:n}))throw new Error(`Docusaurus error: The <Tabs> has a defaultValue "${e}" but none of its children has the corresponding value. Available values are: ${n.map((e=>e.value)).join(", ")}. If you intend to show no default tab, use defaultValue={null} instead.`);return e}const t=n.find((e=>e.default))??n[0];if(!t)throw new Error("Unexpected error: 0 tabValues");return t.value}({defaultValue:n,tabValues:s}))),[c,d]=f({queryString:t,groupId:a}),[j,b]=function({groupId:e}){const n=function(e){return e?`docusaurus.tab.${e}`:null}(e),[t,a]=(0,o.Dv)(n);return[t,(0,r.useCallback)((e=>{n&&a.set(e)}),[n,a])]}({groupId:a}),g=(()=>{const e=c??j;return p({value:e,tabValues:s})?e:null})();(0,i.A)((()=>{g&&u(g)}),[g]);return{selectedValue:l,selectValue:(0,r.useCallback)((e=>{if(!p({value:e,tabValues:s}))throw new Error(`Can't select invalid tab value=${e}`);u(e),d(e),b(e)}),[d,b,s]),tabValues:s}}var b=t(1310);const g={tabList:"tabList_M0Dn",tabItem:"tabItem_ysIP"};var v=t(4848);function m({className:e,block:n,selectedValue:t,selectValue:r,tabValues:l}){const i=[],{blockElementScrollPositionUntilNextRender:u}=(0,s.a_)(),c=e=>{const n=e.currentTarget,a=i.indexOf(n),s=l[a].value;s!==t&&(u(n),r(s))},o=e=>{let n=null;switch(e.key){case"Enter":c(e);break;case"ArrowRight":{const t=i.indexOf(e.currentTarget)+1;n=i[t]??i[0];break}case"ArrowLeft":{const t=i.indexOf(e.currentTarget)-1;n=i[t]??i[i.length-1];break}}n?.focus()};return(0,v.jsx)("ul",{role:"tablist","aria-orientation":"horizontal",className:(0,a.A)("tabs",{"tabs--block":n},e),children:l.map((({value:e,label:n,attributes:r})=>(0,v.jsx)("li",{role:"tab",tabIndex:t===e?0:-1,"aria-selected":t===e,ref:e=>{i.push(e)},onKeyDown:o,onClick:c,...r,className:(0,a.A)("tabs__item",g.tabItem,r?.className,{"tabs__item--active":t===e}),children:n??e},e)))})}function x({lazy:e,children:n,selectedValue:t}){const s=(Array.isArray(n)?n:[n]).filter(Boolean);if(e){const e=s.find((e=>e.props.value===t));return e?(0,r.cloneElement)(e,{className:(0,a.A)("margin-top--md",e.props.className)}):null}return(0,v.jsx)("div",{className:"margin-top--md",children:s.map(((e,n)=>(0,r.cloneElement)(e,{key:n,hidden:e.props.value!==t})))})}function y(e){const n=j(e);return(0,v.jsxs)("div",{className:(0,a.A)("tabs-container",g.tabList),children:[(0,v.jsx)(m,{...n,...e}),(0,v.jsx)(x,{...n,...e})]})}function S(e){const n=(0,b.A)();return(0,v.jsx)(y,{...e,children:d(e.children)},String(n))}},1184:(e,n,t)=>{t.d(n,{R:()=>l,x:()=>i});var r=t(6540);const a={},s=r.createContext(a);function l(e){const n=r.useContext(s);return r.useMemo((function(){return"function"==typeof e?e(n):{...n,...e}}),[n,e])}function i(e){let n;return n=e.disableParentContext?"function"==typeof e.components?e.components(a):e.components||a:l(e.components),r.createElement(s.Provider,{value:n},e.children)}}}]);